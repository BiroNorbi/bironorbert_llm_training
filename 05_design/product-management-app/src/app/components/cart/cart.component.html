<div class="cart-container" [class.expanded]="isExpanded()">
  <div class="cart-header" (click)="toggleCart()">
    <div class="cart-title">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1 1H3.8L4.4 3M4.4 3H19L16.2 11H6.2L4.4 3Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="7" cy="17" r="1.5" stroke="currentColor" stroke-width="1.5"/>
        <circle cx="15" cy="17" r="1.5" stroke="currentColor" stroke-width="1.5"/>
      </svg>
      <span>Cart</span>
      @if (getTotalItems() > 0) {
        <span class="cart-badge">{{ getTotalItems() }}</span>
      }
    </div>
    <svg class="toggle-icon" [class.rotated]="isExpanded()" width="14" height="8" viewBox="0 0 14 8" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M1 1L7 7L13 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>

  @if (isExpanded()) {
    <div class="cart-content">
      @if (cartItems().length === 0) {
        <div class="empty-cart">
          <p>Your cart is empty</p>
        </div>
      } @else {
        <div class="cart-items">
          @for (item of cartItems(); track item.id) {
            <div class="cart-item">
              <div class="item-info">
                <span class="item-name">{{ item.product_name }}</span>
                <span class="item-quantity">x{{ item.quantity }}</span>
              </div>
              <div class="item-actions">
                <span class="item-price">${{ item.total_price.toFixed(2) }}</span>
                <button class="remove-btn" (click)="removeItem(item.id)" title="Remove">
                  <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 2L12 12M2 12L12 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                </button>
              </div>
            </div>
          }
        </div>

        <div class="cart-footer">
          <div class="total">
            <span class="total-label">Total:</span>
            <span class="total-price">${{ getTotalPrice().toFixed(2) }}</span>
          </div>
          <button class="clear-btn" (click)="clearCart()">Clear Cart</button>
        </div>
      }
    </div>
  }
</div>
